<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ASTDX Update Log</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@900&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>

  <style>
    :root {
      --bg-dark: #121212;
      --bg-light-dark: #1e1e1e;
      --card-bg: #2a2a2a;
      --text-primary: #e0e0e0;
      --text-secondary: #a0a0a0;
      --accent-green: #00FFA3;
      --accent-blue: #007bff;
      --accent-red: #ff4d4d;
      --border-color: #444;
      --font-main: 'Fredoka', sans-serif;
      --font-jp: 'Noto Sans JP', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: var(--font-main);
      color: var(--text-primary);
      background-color: var(--bg-dark);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
    }

    #loader-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--bg-dark);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-in-out;
    }

    #loader-bar-container {
      width: 80%;
      max-width: 400px;
      height: 10px;
      background-color: var(--border-color);
      border-radius: 5px;
      overflow: hidden;
    }

    #loader-progress {
      width: 0%;
      height: 100%;
      background-color: var(--accent-green);
      border-radius: 5px;
      transition: width 0.2s linear;
    }

    #loader-text {
      margin-top: 1rem;
      font-size: 1rem;
      color: var(--text-secondary);
    }

    main {
      width: 100%;
      max-width: 1400px;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease;
    }

    main.loaded {
      opacity: 1;
      visibility: visible;
    }

    .background-design {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background-color: var(--bg-dark);
      background-image: repeating-linear-gradient(0deg, transparent, transparent 49px, rgba(255, 255, 255, 0.04) 50px),
        repeating-linear-gradient(90deg, transparent, transparent 49px, rgba(255, 255, 255, 0.04) 50px),
        radial-gradient(ellipse at 50% 0%, rgb(0, 0, 0) 0%, transparent 70%),
        linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-light-dark) 100%);
      background-size: 50px 50px,
        50px 50px,
        100% 100%,
        100% 100%;
    }

    .content-card {
      background-color: var(--card-bg);
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      border: 1px solid var(--border-color);
      position: relative;
      overflow: hidden;
    }

    .hiragana-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      background: linear-gradient(to right, #1d1d1d, #000000);
    }

    .hiragana-background::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 2;
      --stripe-opacity: 0.6;
      background: repeating-linear-gradient(135deg, transparent, transparent 7px, rgba(0, 0, 0, var(--stripe-opacity)) 7px, rgba(0, 0, 0, var(--stripe-opacity)) 12px);
    }

    .hiragana-background .text-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 3;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .hiragana-background .text-layer {
      width: 200%;
      display: flex;
      font-family: var(--font-jp);
      font-weight: 900;
      white-space: nowrap;
      user-select: none;
      line-height: 0.9;
      rotate: -10deg;
      font-size: 20rem;
      background: linear-gradient(45deg, #ffffff, #303030);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      opacity: 0.08;
    }

    .hiragana-background .text-layer span {
      display: block;
      width: 50%;
      padding: 0 20px;
    }

    .hiragana-background .layer-1 {
      animation: scroll-right 40s linear infinite;
    }

    .hiragana-background .layer-2 {
      animation: scroll-left 40s linear infinite;
    }

    .hiragana-background .layer-3 {
      animation: scroll-right 40s linear infinite;
    }

    .hiragana-background .layer-4 {
      animation: scroll-left 40s linear infinite;
    }

    @keyframes scroll-right {
      from {
        transform: translateX(-50%);
      }

      to {
        transform: translateX(0);
      }
    }

    @keyframes scroll-left {
      from {
        transform: translateX(0);
      }

      to {
        transform: translateX(-50%);
      }
    }

    .content-wrapper {
      position: relative;
      z-index: 5;
      padding: 40px;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .music-player {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      background: rgba(30, 30, 30, 0.7);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      padding: 10px 15px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      z-index: 10;
    }

    .music-player button {
      background: none;
      border: none;
      font-size: 1.2rem;
      color: var(--text-primary);
      cursor: pointer;
      transition: color 0.2s ease, transform 0.2s ease;
    }

    .music-player button:hover {
      color: var(--accent-green);
      transform: scale(1.1);
    }

    .main-header {
      font-size: clamp(3rem, 6vw, 4.5rem);
      font-weight: 700;
      line-height: 1.2;
      margin: 0;
      opacity: 0;
    }

    .main-header .letter {
      display: inline-block;
      -webkit-text-fill-color: transparent;
      background: linear-gradient(45deg, #009dff, #087dd7, #009dff, #087dd7);
      -webkit-background-clip: text;
      background-clip: text;
      background-size: 300% auto;
      animation: gradient-flow 6s linear infinite;
    }

    @keyframes gradient-flow {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    .sub-text {
      font-size: clamp(1.2rem, 3vw, 1.5rem);
      font-weight: 400;
      margin: 0;
      color: var(--text-secondary);
      opacity: 0;
    }

    .content-box {
      background-color: rgba(30, 30, 30, 0.7);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      opacity: 0;
    }

    .content-box h2 {
      margin-top: 0;
      font-weight: 600;
      color: var(--accent-green);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 10px;
      margin-bottom: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .content-box p {
      font-size: 1.1rem;
      line-height: 1.6;
      font-weight: 300;
      margin: 0.5rem 0;
    }

    .unit-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 1rem;
      padding-top: 1rem;
    }

    .unit-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem;
      border: 2px solid transparent;
      border-radius: 10px;
      background-color: var(--bg-dark);
      transition: all 0.2s ease-in-out;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      opacity: 0;
      cursor: pointer;
    }

    .unit-card:hover {
      border-color: var(--accent-blue);
      transform: translateY(-3px);
    }

    .unit-card.selected {
      border-color: var(--accent-green);
      transform: translateY(-3px);
      box-shadow: 0 0 10px rgba(0, 255, 163, 0.5);
    }

    .unit-card img {
      width: 90px;
      height: 90px;
      object-fit: cover;
      border-radius: 8px;
    }

    .unit-card p {
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--text-primary);
      text-transform: capitalize;
    }

    .logo img {
      width: 500px;
      height: auto;
    }

    .logo {
      text-align: center;
    }

    /* --- Layout & Details Panel Styles --- */
    .changelog-layout {
      display: grid;
      grid-template-columns: 2fr 1.2fr;
      gap: 25px;
      margin-top: 1rem;
    }

    #unit-details-panel {
      background-color: rgba(30, 30, 30, 0.7);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      opacity: 0;
      position: sticky;
      top: 2rem;
      align-self: start;
    }

    .details-placeholder {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
      color: var(--text-secondary);
      font-style: italic;
    }

    .details-content-wrapper {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    
    /* --- NEW/MODIFIED STYLES START HERE --- */
    
    .details-header {
      display: flex;
      gap: 1.5rem;
      align-items: center;
    }
    
    .details-title-group {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    #details-unit-image {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    #details-unit-name {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--text-primary);
      text-transform: uppercase;
      margin: 0;
      line-height: 1.1;
    }

    .details-subheader {
        font-size: 1rem;
        font-weight: 600;
        text-transform: uppercase;
        color: var(--text-secondary); /* For the '•' separator */
        margin: 0;
    }
    .details-subheader span {
        display: inline-block; /* Helps with gradient rendering */
    }
    .details-subheader .subheader-placement {
        color: #c9a449; /* Gold/bronze color for placement */
    }
    
    .details-tags-container {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
    }

    .details-tag {
        background-color: var(--bg-dark);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        padding: 0.4rem 1rem;
        font-size: 0.9rem;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .tag-element.element-red { border-color: #ff8080; color: #ff8080; }
    .tag-element.element-green { border-color: #99ffc7; color: #99ffc7; }
    .tag-element.element-blue { border-color: #99c7ff; color: #99c7ff; }
    .tag-element.element-purple { border-color: #e4c2ff; color: #e4c2ff; }
    .tag-element.element-orange { border-color: #ffc799; color: #ffc799; }
    
    .tag-method {
        border-color: var(--accent-blue);
        color: var(--accent-blue);
    }
    
    .rarity-unbound {
      background-image: linear-gradient(45deg, #c0392b, #8e44ad);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .rarity-5-star {
      background-image: linear-gradient(45deg, #ff2400, #e8b71d, #1de840, #1ddde8, #2b1de8, #dd00f3, #ff2400);
      background-size: 400% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: rainbow-flow 5s ease-in-out infinite;
    }

    /* Keyframes for the rainbow animation */
    @keyframes rainbow-flow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    /* Highlight Classes */
    .highlight-text-green { color: var(--accent-green); font-weight: 500; }
    .highlight-text-blue { color: var(--accent-blue); font-weight: 500; }
    .highlight-text-red { color: var(--accent-red); font-weight: 500; }

    /* Simple & Clean Passive Content Styling */
    #details-unit-passive {
      border-top: 1px solid var(--border-color);
      padding-top: 1.25rem;
      margin-top: 1.25rem;
    }
    #details-unit-passive > strong {
      display: block;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 1rem;
    }
    .passive-columns {
      display: grid;
      grid-template-columns: repeat(var(--grid-columns, 1), 1fr);
      gap: 1.5rem;
    }
    .passive-column {
      padding: 0;
      border-left: 2px solid var(--border-color);
      padding-left: 1rem;
    }
    .passive-column h3 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }
    .passive-column-content p {
      font-size: 0.95rem !important;
      color: var(--text-secondary) !important;
      line-height: 1.6 !important;
      margin: 0;
    }
    .passive-column-content p + p {
        margin-top: 0.5em;
    }

    /* Responsive adjustments */
    @media (max-width: 1200px) {
      .changelog-layout {
        grid-template-columns: 1fr;
      }
      #unit-details-panel {
        position: static;
        top: auto;
      }
    }
    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }
      .content-wrapper {
        padding: 25px;
      }
      .hiragana-background .text-layer {
        font-size: 12rem;
      }
      .details-header {
        flex-direction: column;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <div id="loader-wrapper">
    <div id="loader-bar-container"><div id="loader-progress"></div></div>
    <p id="loader-text">Loading Assets...</p>
  </div>
  
  <div class="background-design"></div>

  <main>
    <section class="logo">
      <img id="logo_frame" src="assets/logo/images/ASTD_00000.png" alt="logo animation">
    </section>
    <section class="content-card">
      <div class="hiragana-background" translate="no">
        <div class="text-container">
          <div class="text-layer layer-1"><span>あいうえおかきくけこさしすせそ</span></div>
          <div class="text-layer layer-2"><span>タチツテトナニヌネノハヒフヘホ</span></div>
          <div class="text-layer layer-3"><span>マミムメモヤユヨラリルレロ</span></div>
          <div class="text-layer layer-4"><span>ワヲンアイウエオカキクケコサ</span></div>
        </div>
      </div>
      
      <audio id="audio-player" src="assets/All Star Tower Defense Lobby Music (Roblox) [LaTale Music - May Be Happy].mp3" loop></audio>
      <div class="music-player"><button id="play-pause">▶</button></div>

      <div class="content-wrapper">
        <h1 class="main-header">ASTDX Update Log</h1>
        <p class="sub-text">Made by the ASTDX Questions Team</p>
        
        <div class="changelog-layout">
          <div class="main-content-column">
            <div class="content-box">
              <h2>New Unit Additions</h2>
              <div id="new-units-grid" class="unit-grid"></div>
            </div>
          </div>
          <div id="unit-details-panel"></div>
        </div>
        <div class="content-box" style="margin-top: 25px;">
          <h2>Koishi</h2>
          <p>More update info can go here...</p>
        </div>
      </div>
    </section>
  </main>
  
  <script src="changelog-units.js"></script>
  
  <script>
    const loaderWrapper = document.getElementById('loader-wrapper');
    const loaderProgress = document.getElementById('loader-progress');
    const mainContent = document.querySelector('main');

    let progress = 0;
    const interval = setInterval(() => {
      progress += Math.random() * 5;
      if (progress > 99) { progress = 99; }
      loaderProgress.style.width = progress + '%';
    }, 100);

    const detailsPanel = document.getElementById('unit-details-panel');
    const placeholderHTML = `<div class="details-placeholder"><p>Click a new unit to see details.</p></div>`;

    function generatePassiveHTML(passiveData) {
        const columnCount = passiveData.columnCount || 1;
        const columnsHTML = passiveData.columns.map(col => {
            const contentHTML = col.content.map(line => `<p>${line}</p>`).join('');
            
            return `
                <div class="passive-column">
                    <h3>${col.heading}</h3>
                    <div class="passive-column-content">
                        ${contentHTML}
                    </div>
                </div>
            `;
        }).join('');

        return `
            <strong>${passiveData.title || 'Passive Ability:'}</strong>
            <div class="passive-columns" style="--grid-columns: ${columnCount};">
                ${columnsHTML}
            </div>
        `;
    }

    function updateDetailsPanel(unitData) {
      if (!unitData) {
        detailsPanel.innerHTML = placeholderHTML;
        return;
      }
      
      const subheaderHTML = `<p class="details-subheader">
          <span class="rarity-${unitData.rarity.toLowerCase().replace(' ', '-')}">${unitData.rarity}</span> • <span class="subheader-placement">${unitData.placement}</span>
        </p>`;

      const elementClass = `element-${unitData.element.toLowerCase()}`;
      const passiveHTML = generatePassiveHTML(unitData.passive);

      detailsPanel.innerHTML = `
        <div class="details-content-wrapper">
          <div class="details-header">
            <img id="details-unit-image" src="${unitData.image}" alt="${unitData.name}">
            <div class="details-title-group">
                <h2 id="details-unit-name">${unitData.name}</h2>
                ${subheaderHTML}
            </div>
          </div>
          
          <div class="details-tags-container">
            <div class="details-tag tag-element ${elementClass}">
                <span>${unitData.element}</span>
            </div>
            <div class="details-tag tag-method">
                <span>${unitData.method}</span>
            </div>
          </div>

          <div id="details-unit-passive">
            ${passiveHTML}
          </div>
        </div>
      `;
      anime({ targets: '.details-content-wrapper', opacity: [0, 1], translateY: [10, 0], duration: 500, easing: 'easeOutExpo' });
    }

    const startApp = () => {
      const newUnitsGrid = document.getElementById('new-units-grid');

      const populateNewUnits = () => {
        if (!newUnitsGrid) return; 
        
        if (typeof newUnitsData !== 'undefined' && newUnitsData.length > 0) {
          newUnitsGrid.innerHTML = newUnitsData.map(unit => `
            <div class="unit-card" data-unit-name="${unit.name}">
              <img src="${unit.image}" alt="${unit.name}">
              <p>${unit.name}</p>
            </div>
          `).join('');
        } else {
          newUnitsGrid.innerHTML = "<p>No new units in this update.</p>";
        }
      };
      
      populateNewUnits();
      updateDetailsPanel(null);

      function setupUnitInteractions() {
          newUnitsGrid.addEventListener('click', (event) => {
              const card = event.target.closest('.unit-card');
              if (!card) return;

              const currentlySelected = newUnitsGrid.querySelector('.unit-card.selected');
              if (currentlySelected) {
                currentlySelected.classList.remove('selected');
              }
              card.classList.add('selected');

              const unitName = card.dataset.unitName;
              const unitData = newUnitsData.find(u => u.name === unitName);
              updateDetailsPanel(unitData);
          });
      }
      setupUnitInteractions();

      const header = document.querySelector('.main-header');
      header.innerHTML = header.textContent.replace(/\S/g, "<span class='letter'>$&</span>");
      
      const tl = anime.timeline({ easing: 'easeOutExpo', duration: 750 });
      tl.add({ targets: '.main-header', opacity: [0, 1], duration: 200 })
        .add({ targets: '.main-header .letter', translateY: [20, 0], opacity: [0, 1], duration: 1200, delay: anime.stagger(50) }, '-=100')
        .add({ targets: '.sub-text', translateY: [15, 0], opacity: [0, 1], duration: 800 }, '-=1000')
        .add({ targets: ['.content-box', '#unit-details-panel'], translateY: [20, 0], opacity: [0, 1], delay: anime.stagger(100) }, '-=700')
        .add({ targets: '.unit-card', translateY: [15, 0], opacity: [0, 1], delay: anime.stagger(80) }, '-=800');
    };

    window.addEventListener('load', () => {
      clearInterval(interval);
      loaderProgress.style.width = '100%';
      setTimeout(() => {
        loaderWrapper.style.opacity = '0';
        loaderWrapper.addEventListener('transitionend', () => {
          loaderWrapper.style.display = 'none';
          mainContent.classList.add('loaded');
          startApp();
        }, { once: true }); 
      }, 500); 
    });
  </script>

  <script src="assets/musicplayer.js"></script>
  <script src="assets/logo/logo_animation.js"></script>
</body>